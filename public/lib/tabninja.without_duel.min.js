/*!
 * TabNinja JavaScript Library v0.0.1-w
 * https://github.com/studentIvan/tabninja
 *
 * Copyright 2015 Maslov Ivan
 * Released under the MIT license
 * https://raw.githubusercontent.com/studentIvan/tabninja/master/LICENSE
 */

tabNinja={},tabNinja.isLocalStorageAvailable=function(){try{return"localStorage"in window&&null!==window.localStorage&&void 0!==window.localStorage}catch(a){return!1}},tabNinja.addEvent=function(){return document.addEventListener?function(a,t,n){if(a&&a.nodeName||a===window)a.addEventListener(t,n,!1);else if(a&&a.length)for(var e=0;e<a.length;e++)addEvent(a[e],t,n)}:function(a,t,n){if(a&&a.nodeName||a===window)a.attachEvent("on"+t,function(){return n.call(a,window.event)});else if(a&&a.length)for(var e=0;e<a.length;e++)addEvent(a[e],t,n)}}(),tabNinja.localStorageAvailable=tabNinja.isLocalStorageAvailable(),tabNinja.ninjaName=-1,tabNinja.localStorageAvailable&&(sessionStorage.getItem("tabninja:here")||(sessionStorage.setItem("tabninja:here","yes"),localStorage.setItem("tabninja:stack",""))),tabNinja.isSuperMaster=function(){if(!tabNinja.localStorageAvailable)return!0;try{var a=JSON.parse(localStorage.getItem("tabninja:stack"));return-1===tabNinja.ninjaName&&(tabNinja.ninjaName=+Math.max.apply(0,a)+1),-1===a.indexOf(tabNinja.ninjaName)?(a.push(tabNinja.ninjaName),localStorage.setItem("tabninja:stack",JSON.stringify(a)),!1):0===a.indexOf(tabNinja.ninjaName)}catch(t){return tabNinja.ninjaName=1,localStorage.setItem("tabninja:stack","[1]"),!0}},tabNinja.killCurrentNinja=function(){localStorage.setItem("tabninja:unloaded",1);try{var a=JSON.parse(localStorage.getItem("tabninja:stack"));a.splice(a.indexOf(tabNinja.ninjaName),1),a.length>0?localStorage.setItem("tabninja:stack",JSON.stringify(a)):localStorage.setItem("tabninja:stack","")}catch(t){localStorage.setItem("tabninja:stack","")}},tabNinja.isSuperMaster(),window.isSuperMaster=tabNinja.isSuperMaster,tabNinja.addEvent(window,"unload",tabNinja.killCurrentNinja);